"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var e,r,n=t(require("jsbi")),i=t(require("tiny-invariant")),o=require("@uniswap/sdk-core"),u=t(require("big.js")),a=t(require("toformat")),s=require("@mysten/sui.js");function c(){c=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function p(t,e,r,i){var o=Object.create((e&&e.prototype instanceof f?e:f).prototype),u=new q(i||[]);return n(o,"_invoke",{value:A(t,r,u)}),o}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=p;var l={};function f(){}function h(){}function m(){}var g={};s(g,o,(function(){return this}));var v=Object.getPrototypeOf,k=v&&v(v(S([])));k&&k!==e&&r.call(k,o)&&(g=k);var y=m.prototype=f.prototype=Object.create(g);function x(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){var i;n(this,"_invoke",{value:function(n,o){function u(){return new e((function(i,u){!function n(i,o,u,a){var s=d(t[i],t,o);if("throw"!==s.type){var c=s.arg,p=c.value;return p&&"object"==typeof p&&r.call(p,"__await")?e.resolve(p.__await).then((function(t){n("next",t,u,a)}),(function(t){n("throw",t,u,a)})):e.resolve(p).then((function(t){c.value=t,u(c)}),(function(t){return n("throw",t,u,a)}))}a(s.arg)}(n,o,i,u)}))}return i=i?i.then(u,u):u()}})}function A(t,e,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var u=r.delegate;if(u){var a=T(u,r);if(a){if(a===l)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=d(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}function T(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,T(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),l;var i=d(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,l;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function q(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function S(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:_}}function _(){return{value:void 0,done:!0}}return h.prototype=m,n(y,"constructor",{value:m,configurable:!0}),n(m,"constructor",{value:h,configurable:!0}),h.displayName=s(m,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},x(w.prototype),s(w.prototype,u,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var u=new w(p(e,r,n,i),o);return t.isGeneratorFunction(r)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},x(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=S,q.prototype={constructor:q,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return u.type="throw",u.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],u=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),s=r.call(o,"finallyLoc");if(a&&s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var u=o?o.completion:{};return u.type=t,u.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(u)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;I(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:S(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},t}function p(t,e,r,n,i,o,u){try{var a=t[o](u),s=a.value}catch(t){return void r(t)}a.done?e(s):Promise.resolve(s).then(n,i)}function d(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function u(t){p(o,n,i,u,a,"next",t)}function a(t){p(o,n,i,u,a,"throw",t)}u(void 0)}))}}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,"symbol"==typeof(i=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key))?i:String(i),n)}var i}function f(t,e,r){return e&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function h(){return(h=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function m(t,e){var r,n;t.prototype=Object.create(e.prototype),t.prototype.constructor=t,r=t,n=e,(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(r,n)}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function v(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return g(t,void 0);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(t,void 0):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(r=exports.FeeAmount||(exports.FeeAmount={}))[r.LOWEST=100]="LOWEST",r[r.LOW=500]="LOW",r[r.MEDIUM=3e3]="MEDIUM",r[r.HIGH=1e4]="HIGH";var k=((e={})[exports.FeeAmount.LOWEST]=1,e[exports.FeeAmount.LOW]=10,e[exports.FeeAmount.MEDIUM]=60,e[exports.FeeAmount.HIGH]=200,e),y="";function x(t){if(t==exports.FeeAmount.LOWEST)return"::fee_spacing::Fee100";if(t==exports.FeeAmount.LOW)return"::fee_spacing::Fee500";if(t==exports.FeeAmount.MEDIUM)return"::fee_spacing::Fee3000";if(t==exports.FeeAmount.HIGH)return"::fee_spacing::Fee10000";throw"invalid fee amount"}function w(t){if(t.endsWith(x(exports.FeeAmount.LOWEST)))return exports.FeeAmount.LOWEST;if(t.endsWith(x(exports.FeeAmount.LOW)))return exports.FeeAmount.LOW;if(t.endsWith(x(exports.FeeAmount.MEDIUM)))return exports.FeeAmount.MEDIUM;if(t.endsWith(x(exports.FeeAmount.HIGH)))return exports.FeeAmount.HIGH;throw"invalid fee type"}var A=n.BigInt(-1),T=n.BigInt(0),b=n.BigInt(1),I=n.exponentiate(n.BigInt(2),n.BigInt(64)),q=n.exponentiate(I,n.BigInt(2)),S=function(){function t(){}return t.addDelta=function(t,e){return n.lessThan(e,T)?n.subtract(t,n.multiply(e,A)):n.add(t,e)},t}(),_=function(){function t(){}return t.mulDivRoundingUp=function(t,e,r){var i=n.multiply(t,e),o=n.divide(i,r);return n.notEqual(n.remainder(i,r),T)&&(o=n.add(o,b)),o},t}(),R=n.subtract(n.exponentiate(n.BigInt(2),n.BigInt(160)),b);function P(t,e){var r=n.multiply(t,e);return n.bitwiseAnd(r,o.MaxUint256)}var O=function(){function t(){}return t.getAmount0Delta=function(t,e,r,i){if(n.greaterThan(t,e)){var o=[e,t];t=o[0],e=o[1]}var u=n.leftShift(r,n.BigInt(64)),a=n.subtract(e,t);return i?_.mulDivRoundingUp(_.mulDivRoundingUp(u,a,e),b,t):n.divide(n.divide(n.multiply(u,a),e),t)},t.getAmount1Delta=function(t,e,r,i){if(n.greaterThan(t,e)){var o=[e,t];t=o[0],e=o[1]}return i?_.mulDivRoundingUp(r,n.subtract(e,t),I):n.divide(n.multiply(r,n.subtract(e,t)),I)},t.getNextSqrtPriceFromInput=function(t,e,r,o){return n.greaterThan(t,T)||i(!1),n.greaterThan(e,T)||i(!1),o?this.getNextSqrtPriceFromAmount0RoundingUp(t,e,r,!0):this.getNextSqrtPriceFromAmount1RoundingDown(t,e,r,!0)},t.getNextSqrtPriceFromOutput=function(t,e,r,o){return n.greaterThan(t,T)||i(!1),n.greaterThan(e,T)||i(!1),o?this.getNextSqrtPriceFromAmount1RoundingDown(t,e,r,!1):this.getNextSqrtPriceFromAmount0RoundingUp(t,e,r,!1)},t.getNextSqrtPriceFromAmount0RoundingUp=function(t,e,r,u){if(n.equal(r,T))return t;var a=n.leftShift(e,n.BigInt(64));if(u){var s=P(r,t);if(n.equal(n.divide(s,r),t)){var c=(d=n.add(a,s),n.bitwiseAnd(d,o.MaxUint256));if(n.greaterThanOrEqual(c,a))return _.mulDivRoundingUp(a,t,c)}return _.mulDivRoundingUp(a,b,n.add(n.divide(a,t),r))}var p=P(r,t);n.equal(n.divide(p,r),t)||i(!1),n.greaterThan(a,p)||i(!1);var d,l=n.subtract(a,p);return _.mulDivRoundingUp(a,t,l)},t.getNextSqrtPriceFromAmount1RoundingDown=function(t,e,r,o){if(o){var u=n.lessThanOrEqual(r,R)?n.divide(n.leftShift(r,n.BigInt(64)),e):n.divide(n.multiply(r,I),e);return n.add(t,u)}var a=_.mulDivRoundingUp(r,I,e);return n.greaterThan(t,a)||i(!1),n.subtract(t,a)},t}(),E=n.exponentiate(n.BigInt(10),n.BigInt(6)),B=function(){function t(){}return t.computeSwapStep=function(t,e,r,i,o){var u={},a=n.greaterThanOrEqual(t,e),s=n.greaterThanOrEqual(i,T);if(s){var c=n.divide(n.multiply(i,n.subtract(E,n.BigInt(o))),E);u.amountIn=a?O.getAmount0Delta(e,t,r,!0):O.getAmount1Delta(t,e,r,!0),u.sqrtRatioNextX96=n.greaterThanOrEqual(c,u.amountIn)?e:O.getNextSqrtPriceFromInput(t,r,c,a)}else u.amountOut=a?O.getAmount1Delta(e,t,r,!1):O.getAmount0Delta(t,e,r,!1),u.sqrtRatioNextX96=n.greaterThanOrEqual(n.multiply(i,A),u.amountOut)?e:O.getNextSqrtPriceFromOutput(t,r,n.multiply(i,A),a);var p=n.equal(e,u.sqrtRatioNextX96);return a?(u.amountIn=p&&s?u.amountIn:O.getAmount0Delta(u.sqrtRatioNextX96,t,r,!0),u.amountOut=p&&!s?u.amountOut:O.getAmount1Delta(u.sqrtRatioNextX96,t,r,!1)):(u.amountIn=p&&s?u.amountIn:O.getAmount1Delta(t,u.sqrtRatioNextX96,r,!0),u.amountOut=p&&!s?u.amountOut:O.getAmount0Delta(t,u.sqrtRatioNextX96,r,!1)),!s&&n.greaterThan(u.amountOut,n.multiply(i,A))&&(u.amountOut=n.multiply(i,A)),u.feeAmount=s&&n.notEqual(u.sqrtRatioNextX96,e)?n.subtract(i,u.amountIn):_.mulDivRoundingUp(u.amountIn,n.BigInt(o),n.subtract(E,n.BigInt(o))),[u.sqrtRatioNextX96,u.amountIn,u.amountOut,u.feeAmount]},t}(),C=n.BigInt(2),N=[128,64,32,16,8,4,2,1].map((function(t){return[t,n.exponentiate(C,n.BigInt(t))]}));function L(t){n.greaterThan(t,T)||i(!1),n.lessThanOrEqual(t,o.MaxUint256)||i(!1);for(var e,r=0,u=v(N);!(e=u()).done;){var a=e.value,s=a[0];n.greaterThanOrEqual(t,a[1])&&(t=n.signedRightShift(t,n.BigInt(s)),r+=s)}return r}function U(t,e){return n.signedRightShift(n.multiply(t,n.BigInt(e)),n.BigInt(128))}var F=n.exponentiate(n.BigInt(2),n.BigInt(32)),X=function(){function t(){}return t.getSqrtRatioAtTick=function(e){return n.divide(t.getSqrtRatioAtTickInternal(e),F)},t.getSqrtRatioAtTickInternal=function(e){e>=t.MIN_TICK&&e<=t.MAX_TICK&&Number.isInteger(e)||i(!1);var r=e<0?-1*e:e,u=n.BigInt(0!=(1&r)?"0xfffcb933bd6fad37aa2d162d1a594001":"0x100000000000000000000000000000000");return 0!=(2&r)&&(u=U(u,"0xfff97272373d413259a46990580e213a")),0!=(4&r)&&(u=U(u,"0xfff2e50f5f656932ef12357cf3c7fdcc")),0!=(8&r)&&(u=U(u,"0xffe5caca7e10e4e61c3624eaa0941cd0")),0!=(16&r)&&(u=U(u,"0xffcb9843d60f6159c9db58835c926644")),0!=(32&r)&&(u=U(u,"0xff973b41fa98c081472e6896dfb254c0")),0!=(64&r)&&(u=U(u,"0xff2ea16466c96a3843ec78b326b52861")),0!=(128&r)&&(u=U(u,"0xfe5dee046a99a2a811c461f1969c3053")),0!=(256&r)&&(u=U(u,"0xfcbe86c7900a88aedcffc83b479aa3a4")),0!=(512&r)&&(u=U(u,"0xf987a7253ac413176f2b074cf7815e54")),0!=(1024&r)&&(u=U(u,"0xf3392b0822b70005940c7a398e4b70f3")),0!=(2048&r)&&(u=U(u,"0xe7159475a2c29b7443b29c7fa6e889d9")),0!=(4096&r)&&(u=U(u,"0xd097f3bdfd2022b8845ad8f792aa5825")),0!=(8192&r)&&(u=U(u,"0xa9f746462d870fdf8a65dc1f90e061e5")),0!=(16384&r)&&(u=U(u,"0x70d869a156d2a1b890bb3df62baf32f7")),0!=(32768&r)&&(u=U(u,"0x31be135f97d08fd981231505542fcfa6")),0!=(65536&r)&&(u=U(u,"0x9aa508b5b7a84e1c677de54f3e99bc9")),0!=(131072&r)&&(u=U(u,"0x5d6af8dedb81196699c329225ee604")),0!=(262144&r)&&(u=U(u,"0x2216e584f5fa1ea926041bedfe98")),0!=(524288&r)&&(u=U(u,"0x48a170391f7dc42444e8fa2")),e>0&&(u=n.divide(o.MaxUint256,u)),n.greaterThan(n.remainder(u,F),T)?n.add(n.divide(u,F),b):n.divide(u,F)},t.getTickAtSqrtRatioFromString=function(e){return t.getTickAtSqrtRatio(n.BigInt(e))},t.getTickAtSqrtRatio=function(e){n.greaterThanOrEqual(e,t.MIN_SQRT_RATIO)&&n.lessThan(e,t.MAX_SQRT_RATIO)||i(!1);var r,o=n.leftShift(e,n.BigInt(32)),u=n.leftShift(o,n.BigInt(32)),a=L(u);r=n.greaterThanOrEqual(n.BigInt(a),n.BigInt(128))?n.signedRightShift(u,n.BigInt(a-127)):n.leftShift(u,n.BigInt(127-a));for(var s=n.leftShift(n.subtract(n.BigInt(a),n.BigInt(128)),n.BigInt(64)),c=0;c<14;c++){r=n.signedRightShift(n.multiply(r,r),n.BigInt(127));var p=n.signedRightShift(r,n.BigInt(128));s=n.bitwiseOr(s,n.leftShift(p,n.BigInt(63-c))),r=n.signedRightShift(r,p)}var d=n.multiply(s,n.BigInt("255738958999603826347141")),l=n.toNumber(n.signedRightShift(n.subtract(d,n.BigInt("3402992956809132418596140100660247210")),n.BigInt(128))),f=n.toNumber(n.signedRightShift(n.add(d,n.BigInt("291339464771989622907027621153398088495")),n.BigInt(128)));return l===f?l:n.lessThanOrEqual(t.getSqrtRatioAtTick(f),n.divide(o,F))?f:l},t}();X.MIN_TICK=-443636,X.MAX_TICK=-X.MIN_TICK,X.MIN_SQRT_RATIO=n.BigInt("4295048016"),X.MAX_SQRT_RATIO=n.BigInt("79226673515401279992447579061");var M=function(){function t(){}var e=t.prototype;return e.getTick=function(){var e=d(c().mark((function e(r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error(t.ERROR_MESSAGE);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.nextInitializedTickWithinOneWord=function(){var e=d(c().mark((function e(r,n,i){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error(t.ERROR_MESSAGE);case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),t}();function j(t,e){for(var r=0;r<t.length-1;r++)if(e(t[r],t[r+1])>0)return!1;return!0}function D(t,e){return t.index-e.index}M.ERROR_MESSAGE="No tick data provider was given";var W=function(){function t(){}return t.validateList=function(t,e){e>0||i(!1),t.every((function(t){return t.index%e==0}))||i(!1),n.equal(t.reduce((function(t,e){return n.add(t,e.liquidityNet)}),T),T)||i(!1),j(t,D)||i(!1)},t.isBelowSmallest=function(t,e){return t.length>0||i(!1),e<t[0].index},t.isAtOrAboveLargest=function(t,e){return t.length>0||i(!1),e>=t[t.length-1].index},t.getTick=function(t,e){var r=t[this.binarySearch(t,e)];return r.index!==e&&i(!1),r},t.binarySearch=function(t,e){this.isBelowSmallest(t,e)&&i(!1);for(var r,n=0,o=t.length-1;;){if(t[r=Math.floor((n+o)/2)].index<=e&&(r===t.length-1||t[r+1].index>e))return r;t[r].index<e?n=r+1:o=r-1}},t.nextInitializedTick=function(e,r,n){return n?(t.isBelowSmallest(e,r)&&i(!1),t.isAtOrAboveLargest(e,r)?e[e.length-1]:e[this.binarySearch(e,r)]):(this.isAtOrAboveLargest(e,r)&&i(!1),this.isBelowSmallest(e,r)?e[0]:e[this.binarySearch(e,r)+1])},t.nextInitializedTickWithinOneWord=function(e,r,n,i){var o=Math.floor(r/i);if(n){var u=(o>>8<<8)*i;if(t.isBelowSmallest(e,r))return[u,!1];var a=t.nextInitializedTick(e,r,n).index,s=Math.max(u,a);return[s,s===a]}var c=((1+(o+1>>8)<<8)-1)*i;if(this.isAtOrAboveLargest(e,r))return[c,!1];var p=this.nextInitializedTick(e,r,n).index,d=Math.min(c,p);return[d,d===p]},t}();function G(t,e){var r=n.leftShift(n.BigInt(t),n.BigInt(128)),i=n.BigInt(e),u=n.divide(r,i);return o.sqrt(u)}function H(t,e,r){if(n.greaterThan(t,e)){var i=[e,t];t=i[0],e=i[1]}var o=n.divide(n.multiply(t,e),I);return n.divide(n.multiply(n.BigInt(r),o),n.subtract(e,t))}function K(t,e,r){if(n.greaterThan(t,e)){var i=[e,t];t=i[0],e=i[1]}var o=n.multiply(n.multiply(n.BigInt(r),t),e),u=n.multiply(I,n.subtract(e,t));return n.divide(o,u)}function z(t,e,r){if(n.greaterThan(t,e)){var i=[e,t];t=i[0],e=i[1]}return n.divide(n.multiply(n.BigInt(r),I),n.subtract(e,t))}function Q(t,e,r,i,o,u){if(n.greaterThan(e,r)){var a=[r,e];e=a[0],r=a[1]}var s=u?K:H;if(n.lessThanOrEqual(t,e))return s(e,r,i);if(n.lessThan(t,r)){var c=s(t,r,i),p=z(e,t,o);return n.lessThan(c,p)?c:p}return z(e,r,o)}function J(t,e){Number.isInteger(t)&&Number.isInteger(e)||i(!1),e>0||i(!1),t>=X.MIN_TICK&&t<=X.MAX_TICK||i(!1);var r=Math.round(t/e)*e;return r<X.MIN_TICK?r+e:r>X.MAX_TICK?r-e:r}var V=n.exponentiate(n.BigInt(2),n.BigInt(256));function Y(t,e){var r=n.subtract(t,e);return n.lessThan(r,T)?n.add(V,r):r}var $=function(){function t(){}return t.getFeeGrowthInside=function(t,e,r,n,i,o,u){var a,s,c,p;return i>=r?(a=t.feeGrowthOutside0X128,s=t.feeGrowthOutside1X128):(a=Y(o,t.feeGrowthOutside0X128),s=Y(u,t.feeGrowthOutside1X128)),i<n?(c=e.feeGrowthOutside0X128,p=e.feeGrowthOutside1X128):(c=Y(o,e.feeGrowthOutside0X128),p=Y(u,e.feeGrowthOutside1X128)),[Y(Y(o,a),c),Y(Y(u,s),p)]},t}(),Z=n.exponentiate(n.BigInt(2),n.BigInt(128)),tt=function(){function t(){}return t.getTokensOwed=function(t,e,r,i,o){return[n.divide(n.multiply(Y(i,t),r),Z),n.divide(n.multiply(Y(o,e),r),Z)]},t.getTokensOwed2=function(e,r,i,o,u){return t.getTokensOwed(n.BigInt(e),n.BigInt(r),n.BigInt(i),n.BigInt(o),n.BigInt(u))},t}(),et=a(u),rt=function(t){function e(e,r,u){var a;return a=t.call(this,r,u)||this,n.lessThanOrEqual(a.quotient,o.MaxUint256)||i(!1),a.currency=e,a.decimalScale=n.exponentiate(n.BigInt(10),n.BigInt(e.decimals)),a}m(e,t),e.fromRawAmount=function(t,r){return new e(t,r)},e.fromFractionalAmount=function(t,r,n){return new e(t,r,n)};var r=e.prototype;return r.add=function(r){this.currency.equals(r.currency)||i(!1);var n=t.prototype.add.call(this,r);return e.fromFractionalAmount(this.currency,n.numerator,n.denominator)},r.subtract=function(r){this.currency.equals(r.currency)||i(!1);var n=t.prototype.subtract.call(this,r);return e.fromFractionalAmount(this.currency,n.numerator,n.denominator)},r.multiply=function(r){var n=t.prototype.multiply.call(this,r);return e.fromFractionalAmount(this.currency,n.numerator,n.denominator)},r.divide=function(r){var n=t.prototype.divide.call(this,r);return e.fromFractionalAmount(this.currency,n.numerator,n.denominator)},r.toSignificant=function(e,r,n){return void 0===e&&(e=6),void 0===n&&(n=o.Rounding.ROUND_DOWN),t.prototype.divide.call(this,this.decimalScale).toSignificant(e,r,n)},r.toFixed=function(e,r,n){return void 0===e&&(e=this.currency.decimals),void 0===n&&(n=o.Rounding.ROUND_DOWN),e<=this.currency.decimals||i(!1),t.prototype.divide.call(this,this.decimalScale).toFixed(e,r,n)},r.toExact=function(t){return void 0===t&&(t={groupSeparator:""}),et.DP=this.currency.decimals,new et(this.quotient.toString()).div(this.decimalScale.toString()).toFormat(t)},f(e,[{key:"wrapped",get:function(){return e.fromFractionalAmount(this.currency.wrapped,this.numerator,this.denominator)}}]),e}(o.Fraction),nt=function(t){function e(){for(var e,r,i,u,a,s=arguments.length,c=new Array(s),p=0;p<s;p++)c[p]=arguments[p];if(4===c.length)r=c[0],i=c[1],u=c[2],a=c[3];else{var d=c[0].quoteAmount.divide(c[0].baseAmount),l=[c[0].baseAmount.currency,c[0].quoteAmount.currency,d.denominator,d.numerator];r=l[0],i=l[1],u=l[2],a=l[3]}return(e=t.call(this,a,u)||this).baseCurrency=r,e.quoteCurrency=i,e.scalar=new o.Fraction(n.exponentiate(n.BigInt(10),n.BigInt(r.decimals)),n.exponentiate(n.BigInt(10),n.BigInt(i.decimals))),e}m(e,t);var r=e.prototype;return r.invert=function(){return new e(this.quoteCurrency,this.baseCurrency,this.numerator,this.denominator)},r.multiply=function(r){this.quoteCurrency.equals(r.baseCurrency)||i(!1);var n=t.prototype.multiply.call(this,r);return new e(this.baseCurrency,r.quoteCurrency,n.denominator,n.numerator)},r.quote=function(e){e.currency.equals(this.baseCurrency)||i(!1);var r=t.prototype.multiply.call(this,e);return rt.fromFractionalAmount(this.quoteCurrency,r.numerator,r.denominator)},r.toSignificant=function(t,e,r){return void 0===t&&(t=6),this.adjustedForDecimals.toSignificant(t,e,r)},r.toFixed=function(t,e,r){return void 0===t&&(t=4),this.adjustedForDecimals.toFixed(t,e,r)},f(e,[{key:"adjustedForDecimals",get:function(){return t.prototype.multiply.call(this,this.scalar)}}]),e}(o.Fraction);function it(t,e,r){var i=X.getSqrtRatioAtTick(r),o=n.multiply(i,i);return t.sortsBefore(e)?new nt(t,e,q,o):new nt(t,e,o,q)}function ot(t){var e=n.BigInt(t).toString(16);return e.length%2!=0&&(e="0"+e),"0x"+e}function ut(t){return n.BigInt(t)}function at(t){var e=n.bitwiseAnd(n.BigInt(t.bits),n.BigInt("9223372036854775808"));return n.equal(e,n.BigInt(0))?parseInt(t.bits):-n.toNumber(n.subtract(n.BigInt("18446744073709551616"),n.BigInt(t.bits)))}function st(t){var e=n.leftShift(n.BigInt(1),n.BigInt(127)),r=n.leftShift(n.BigInt(1),n.BigInt(128));if(n.greaterThan(n.BigInt(t.bits),e)){var i=n.subtract(r,n.BigInt(t.bits)).toString();return n.BigInt("-"+i)}return n.BigInt(t.bits)}function ct(t){var e=n.leftShift(n.BigInt(1),n.BigInt(255)),r=ut(t.bits),i=n.leftShift(n.BigInt(1),n.BigInt(256));if(n.greaterThan(n.BigInt(r),e)){var o=n.subtract(i,n.BigInt(r)).toString();return n.BigInt("-"+o)}return n.BigInt(r)}function pt(t){return dt.apply(this,arguments)}function dt(){return(dt=d(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){return setTimeout(t,e)})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function lt(t,e,r){return ft.apply(this,arguments)}function ft(){return(ft=d(c().mark((function t(e,r,n){var i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:void 0===r&&(r=10),void 0===n&&(n=2e3),i=r;case 3:if(!(r>0)){t.next=22;break}return t.prev=4,t.next=7,e();case 7:return t.abrupt("return",t.sent);case 11:return t.prev=11,t.t0=t.catch(4),console.warn(t.t0.toString()),t.next=16,pt(n);case 16:if(r--,!(i-r>5)){t.next=20;break}return t.next=20,pt(n);case 20:t.next=3;break;case 22:return t.abrupt("return",void 0);case 23:case"end":return t.stop()}}),t,null,[[4,11]])})))).apply(this,arguments)}function ht(t){return"0x"+Buffer.from(t).toString("utf8")}function mt(t,e){return t===e&&i(!1),t.includes("::")&&(t=t),e.includes("::")&&(e=e),t.length<e.length||!(t.length>e.length)&&t<e}var gt=/^vector<(.+)>$/,vt=/^([^:]+)::([^:]+)::(.+)/,kt=/^[^<]+<(.+)>$/,yt=function(){function t(){}var e=t.prototype;return e.parseFromStr=function(t){if("address"===t)return{address:null};if("bool"===t)return{bool:null};if("u8"===t)return{u8:null};if("u16"===t)return{u16:null};if("u32"===t)return{u32:null};if("u64"===t)return{u64:null};if("u128"===t)return{u128:null};if("u256"===t)return{u256:null};if("signer"===t)return{signer:null};var e=t.match(gt);if(e)return{vector:this.parseFromStr(e[1])};var r=t.match(vt);if(r)try{return{struct:{address:r[1],module:r[2],name:r[3].match(/^([^<]+)/)[1],typeParams:this.parseStructTypeTag(r[3])}}}catch(e){throw new Error("Encounter error parsing type args for "+t)}throw new Error("Encounter unexpected token when parsing type args for "+t)},e.parseStructTypeTag=function(t){var e=this,r=t.match(kt);return r?r[1].split(",").map((function(t){return e.parseFromStr(t)})):[]},t}();function xt(t){return(new yt).parseFromStr(t)}function wt(t){if(Object.keys(t).includes("struct")){var e=t.struct,r=e.address+"::"+e.module+"::"+e.name;return e.typeParams.length>0&&(r=r+"<"+e.typeParams.join(",")+">"),r}return""}var At=function(t){var e=t.index,r=t.liquidityGross,o=t.liquidityNet;e>=X.MIN_TICK&&e<=X.MAX_TICK||i(!1),this.index=e,this.liquidityGross=n.BigInt(r),this.liquidityNet=n.BigInt(o)},Tt=function(){function t(t,e){var r=t.map((function(t){return t instanceof At?t:new At(t)}));W.validateList(r,e),this.ticks=r}var e=t.prototype;return e.getTick=function(){var t=d(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",W.getTick(this.ticks,e));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.nextInitializedTickWithinOneWord=function(){var t=d(c().mark((function t(e,r,n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",W.nextInitializedTickWithinOneWord(this.ticks,e,r,n));case 1:case"end":return t.stop()}}),t,this)})));return function(e,r,n){return t.apply(this,arguments)}}(),t}(),bt=new M,It=function(){function t(t,e,r,o,u,a,s,c,p){void 0===s&&(s=bt),Number.isInteger(r)&&r<1e6||i(!1),this.objectId=c,this.poolHash=p;var d=X.getSqrtRatioAtTick(a),l=X.getSqrtRatioAtTick(a+1);n.greaterThanOrEqual(n.BigInt(o),d)&&n.lessThanOrEqual(n.BigInt(o),l)||i(!1);var f=t.sortsBefore(e)?[t,e]:[e,t];this.token0=f[0],this.token1=f[1],this.fee=r,this.sqrtRatioX96=n.BigInt(o),this.liquidity=n.BigInt(u),this.tickCurrent=a,this.tickDataProvider=Array.isArray(s)?new Tt(s,k[r]):s}var e=t.prototype;return e.getPoolType=function(t){return t+"::pool::Pool<"+this.token0.address+","+this.token1.address+","+t+x(this.fee)+">"},e.updateTickProvider=function(t){void 0===t&&(t=bt),this.tickDataProvider=Array.isArray(t)?new Tt(t,k[this.fee]):t},e.involvesToken=function(t){return t.equals(this.token0)||t.equals(this.token1)},e.priceOf=function(t){return this.involvesToken(t)||i(!1),t.equals(this.token0)?this.token0Price:this.token1Price},e.getOutputAmount=function(){var e=d(c().mark((function e(r,o){var u,a,s,p,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.involvesToken(r.currency)||i(!1),u=r.currency.equals(this.token0),e.next=4,this.swap(u,r.quotient,o);case 4:return s=(a=e.sent).sqrtRatioX96,p=a.liquidity,d=a.tickCurrent,e.abrupt("return",[rt.fromRawAmount(u?this.token1:this.token0,n.multiply(a.amountCalculated,A)),new t(this.token0,this.token1,this.fee,s,p,d,this.tickDataProvider,this.objectId,this.poolHash)]);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),e.getInputAmount=function(){var e=d(c().mark((function e(r,i){var o,u,a,s,p;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.currency.equals(this.token1),e.next=3,this.swap(o,n.multiply(r.quotient,A),i);case 3:return a=(u=e.sent).sqrtRatioX96,s=u.liquidity,p=u.tickCurrent,e.abrupt("return",[rt.fromRawAmount(o?this.token0:this.token1,u.amountCalculated),new t(this.token0,this.token1,this.fee,a,s,p,this.tickDataProvider,this.objectId,this.poolHash)]);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),e.swap=function(){var t=d(c().mark((function t(e,r,o){var u,a,s,p,d,l;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o||(o=e?n.add(X.MIN_SQRT_RATIO,b):n.subtract(X.MAX_SQRT_RATIO,b)),e?(n.greaterThan(o,X.MIN_SQRT_RATIO)||i(!1),n.lessThan(o,this.sqrtRatioX96)||i(!1)):(n.lessThan(o,X.MAX_SQRT_RATIO)||i(!1),n.greaterThan(o,this.sqrtRatioX96)||i(!1)),u=n.greaterThanOrEqual(r,T),a={amountSpecifiedRemaining:r,amountCalculated:T,sqrtPriceX96:this.sqrtRatioX96,tick:this.tickCurrent,liquidity:this.liquidity};case 4:if(!n.notEqual(a.amountSpecifiedRemaining,T)||a.sqrtPriceX96==o){t.next=35;break}return(s={}).sqrtPriceStartX96=a.sqrtPriceX96,t.next=9,this.tickDataProvider.nextInitializedTickWithinOneWord(a.tick,e,this.tickSpacing);case 9:if(s.tickNext=(p=t.sent)[0],s.initialized=p[1],s.tickNext<X.MIN_TICK?s.tickNext=X.MIN_TICK:s.tickNext>X.MAX_TICK&&(s.tickNext=X.MAX_TICK),s.sqrtPriceNextX96=X.getSqrtRatioAtTick(s.tickNext),d=B.computeSwapStep(a.sqrtPriceX96,(e?n.lessThan(s.sqrtPriceNextX96,o):n.greaterThan(s.sqrtPriceNextX96,o))?o:s.sqrtPriceNextX96,a.liquidity,a.amountSpecifiedRemaining,this.fee),a.sqrtPriceX96=d[0],s.amountIn=d[1],s.amountOut=d[2],s.feeAmount=d[3],u?(a.amountSpecifiedRemaining=n.subtract(a.amountSpecifiedRemaining,n.add(s.amountIn,s.feeAmount)),a.amountCalculated=n.subtract(a.amountCalculated,s.amountOut)):(a.amountSpecifiedRemaining=n.add(a.amountSpecifiedRemaining,s.amountOut),a.amountCalculated=n.add(a.amountCalculated,n.add(s.amountIn,s.feeAmount))),!n.equal(a.sqrtPriceX96,s.sqrtPriceNextX96)){t.next=32;break}if(!s.initialized){t.next=29;break}return t.t0=n,t.next=25,this.tickDataProvider.getTick(s.tickNext);case 25:t.t1=t.sent.liquidityNet,l=t.t0.BigInt.call(t.t0,t.t1),e&&(l=n.multiply(l,A)),a.liquidity=S.addDelta(a.liquidity,l);case 29:a.tick=e?s.tickNext-1:s.tickNext,t.next=33;break;case 32:n.notEqual(a.sqrtPriceX96,s.sqrtPriceStartX96)&&(a.tick=X.getTickAtSqrtRatio(a.sqrtPriceX96));case 33:t.next=4;break;case 35:return t.abrupt("return",{amountCalculated:a.amountCalculated,sqrtRatioX96:a.sqrtPriceX96,liquidity:a.liquidity,tickCurrent:a.tick});case 36:case"end":return t.stop()}}),t,this)})));return function(e,r,n){return t.apply(this,arguments)}}(),f(t,[{key:"token0Price",get:function(){var t;return null!=(t=this._token0Price)?t:this._token0Price=new nt(this.token0,this.token1,q,n.multiply(this.sqrtRatioX96,this.sqrtRatioX96))}},{key:"token1Price",get:function(){var t;return null!=(t=this._token1Price)?t:this._token1Price=new nt(this.token1,this.token0,n.multiply(this.sqrtRatioX96,this.sqrtRatioX96),q)}},{key:"tickSpacing",get:function(){return k[this.fee]}}]),t}(),qt=function(){function t(t){var e=t.pool,r=t.liquidity,o=t.tickLower,u=t.tickUpper;this._token0Amount=null,this._token1Amount=null,this._mintAmounts=null,o<u||i(!1),o>=X.MIN_TICK&&o%e.tickSpacing==0||i(!1),u<=X.MAX_TICK&&u%e.tickSpacing==0||i(!1),this.pool=e,this.tickLower=o,this.tickUpper=u,this.liquidity=n.BigInt(r)}var e=t.prototype;return e.ratiosAfterSlippage=function(t){var e=this.pool.token0Price.asFraction.multiply(new o.Percent(1).subtract(t)),r=this.pool.token0Price.asFraction.multiply(t.add(1)),i=G(e.numerator,e.denominator);n.lessThanOrEqual(i,X.MIN_SQRT_RATIO)&&(i=n.add(X.MIN_SQRT_RATIO,n.BigInt(1)));var u=G(r.numerator,r.denominator);return n.greaterThanOrEqual(u,X.MAX_SQRT_RATIO)&&(u=n.subtract(X.MAX_SQRT_RATIO,n.BigInt(1))),{sqrtRatioX96Lower:i,sqrtRatioX96Upper:u}},e.mintAmountsWithSlippage=function(e){var r=this.ratiosAfterSlippage(e),n=r.sqrtRatioX96Upper,i=r.sqrtRatioX96Lower,o=new It(this.pool.token0,this.pool.token1,this.pool.fee,i,0,X.getTickAtSqrtRatio(i)),u=new It(this.pool.token0,this.pool.token1,this.pool.fee,n,0,X.getTickAtSqrtRatio(n)),a=t.fromAmounts(h({pool:this.pool,tickLower:this.tickLower,tickUpper:this.tickUpper},this.mintAmounts,{useFullPrecision:!1}));return{amount0:new t({pool:u,liquidity:a.liquidity,tickLower:this.tickLower,tickUpper:this.tickUpper}).mintAmounts.amount0,amount1:new t({pool:o,liquidity:a.liquidity,tickLower:this.tickLower,tickUpper:this.tickUpper}).mintAmounts.amount1}},e.burnAmountsWithSlippage=function(e){var r=this.ratiosAfterSlippage(e),n=r.sqrtRatioX96Upper,i=r.sqrtRatioX96Lower,o=new It(this.pool.token0,this.pool.token1,this.pool.fee,i,0,X.getTickAtSqrtRatio(i)),u=new t({pool:new It(this.pool.token0,this.pool.token1,this.pool.fee,n,0,X.getTickAtSqrtRatio(n)),liquidity:this.liquidity,tickLower:this.tickLower,tickUpper:this.tickUpper}).amount0,a=new t({pool:o,liquidity:this.liquidity,tickLower:this.tickLower,tickUpper:this.tickUpper}).amount1;return{amount0:u.quotient,amount1:a.quotient}},t.fromAmounts=function(e){var r=e.pool,n=e.tickLower,i=e.tickUpper,o=e.amount0,u=e.amount1,a=e.useFullPrecision,s=X.getSqrtRatioAtTick(n),c=X.getSqrtRatioAtTick(i);return new t({pool:r,tickLower:n,tickUpper:i,liquidity:Q(r.sqrtRatioX96,s,c,o,u,a)})},t.fromAmount0=function(e){return t.fromAmounts({pool:e.pool,tickLower:e.tickLower,tickUpper:e.tickUpper,amount0:e.amount0,amount1:o.MaxUint256,useFullPrecision:e.useFullPrecision})},t.fromAmount1=function(e){return t.fromAmounts({pool:e.pool,tickLower:e.tickLower,tickUpper:e.tickUpper,amount0:o.MaxUint256,amount1:e.amount1,useFullPrecision:!0})},f(t,[{key:"token0PriceLower",get:function(){return it(this.pool.token0,this.pool.token1,this.tickLower)}},{key:"token0PriceUpper",get:function(){return it(this.pool.token0,this.pool.token1,this.tickUpper)}},{key:"amount0",get:function(){return null===this._token0Amount&&(this._token0Amount=rt.fromRawAmount(this.pool.token0,this.pool.tickCurrent<this.tickLower?O.getAmount0Delta(X.getSqrtRatioAtTick(this.tickLower),X.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!1):this.pool.tickCurrent<this.tickUpper?O.getAmount0Delta(this.pool.sqrtRatioX96,X.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!1):T)),this._token0Amount}},{key:"amount1",get:function(){return null===this._token1Amount&&(this._token1Amount=rt.fromRawAmount(this.pool.token1,this.pool.tickCurrent<this.tickLower?T:O.getAmount1Delta(X.getSqrtRatioAtTick(this.tickLower),this.pool.tickCurrent<this.tickUpper?this.pool.sqrtRatioX96:X.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!1))),this._token1Amount}},{key:"mintAmounts",get:function(){return null===this._mintAmounts?this.pool.tickCurrent<this.tickLower?{amount0:O.getAmount0Delta(X.getSqrtRatioAtTick(this.tickLower),X.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!0),amount1:T}:this.pool.tickCurrent<this.tickUpper?{amount0:O.getAmount0Delta(this.pool.sqrtRatioX96,X.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!0),amount1:O.getAmount1Delta(X.getSqrtRatioAtTick(this.tickLower),this.pool.sqrtRatioX96,this.liquidity,!0)}:{amount0:T,amount1:O.getAmount1Delta(X.getSqrtRatioAtTick(this.tickLower),X.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!0)}:this._mintAmounts}}]),t}(),St=function(){function t(t,e,r){this._midPrice=null,t.length>0||i(!1);var n=e.wrapped;t[0].involvesToken(n)||i(!1),t[t.length-1].involvesToken(r.wrapped)||i(!1);for(var o,u=[n],a=v(t.entries());!(o=a()).done;){var s=o.value,c=s[1],p=u[s[0]];p.equals(c.token0)||p.equals(c.token1)||i(!1);var d=p.equals(c.token0)?c.token1:c.token0;u.push(d)}this.pools=t,this.tokenPath=u,this.input=e,this.output=null!=r?r:u[u.length-1]}return f(t,[{key:"midPrice",get:function(){if(null!==this._midPrice)return this._midPrice;var t=this.pools.slice(1).reduce((function(t,e){var r=t.price;return t.nextInput.equals(e.token0)?{nextInput:e.token1,price:r.multiply(e.token0Price)}:{nextInput:e.token0,price:r.multiply(e.token1Price)}}),this.pools[0].token0.equals(this.input.wrapped)?{nextInput:this.pools[0].token1,price:this.pools[0].token0Price}:{nextInput:this.pools[0].token0,price:this.pools[0].token1Price}).price;return this._midPrice=new nt(this.input,this.output,t.denominator,t.numerator)}}]),t}();function _t(t,e){return t.inputAmount.currency.equals(e.inputAmount.currency)||i(!1),t.outputAmount.currency.equals(e.outputAmount.currency)||i(!1),t.outputAmount.equalTo(e.outputAmount)?t.inputAmount.equalTo(e.inputAmount)?t.swaps.reduce((function(t,e){return t+e.route.tokenPath.length}),0)-e.swaps.reduce((function(t,e){return t+e.route.tokenPath.length}),0):t.inputAmount.lessThan(e.inputAmount)?-1:1:t.outputAmount.lessThan(e.outputAmount)?1:-1}var Rt,Pt=function(){function t(t){var e=t.routes,r=t.tradeType,n=e[0].inputAmount.currency,o=e[0].outputAmount.currency;e.every((function(t){return n.wrapped.equals(t.route.input.wrapped)}))||i(!1),e.every((function(t){return o.wrapped.equals(t.route.output.wrapped)}))||i(!1),this.swaps=e,this.tradeType=r}t.exactIn=function(){var e=d(c().mark((function e(r,n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.fromRoute(r,n,o.TradeType.EXACT_INPUT));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),t.exactOut=function(){var e=d(c().mark((function e(r,n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.fromRoute(r,n,o.TradeType.EXACT_OUTPUT));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),t.fromRoute=function(){var e=d(c().mark((function e(r,n,u){var a,s,p,d,l,f,h;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new Array(r.tokenPath.length),u!==o.TradeType.EXACT_INPUT){e.next=19;break}n.currency.equals(r.input)||i(!1),a[0]=n.wrapped,d=0;case 5:if(!(d<r.tokenPath.length-1)){e.next=15;break}return l=r.pools[d],e.next=9,l.getOutputAmount(a[d]);case 9:a[d+1]=e.sent[0];case 12:d++,e.next=5;break;case 15:s=rt.fromFractionalAmount(r.input,n.numerator,n.denominator),p=rt.fromFractionalAmount(r.output,a[a.length-1].numerator,a[a.length-1].denominator),e.next=34;break;case 19:n.currency.equals(r.output)||i(!1),a[a.length-1]=n.wrapped,f=r.tokenPath.length-1;case 22:if(!(f>0)){e.next=32;break}return h=r.pools[f-1],e.next=26,h.getInputAmount(a[f]);case 26:a[f-1]=e.sent[0];case 29:f--,e.next=22;break;case 32:s=rt.fromFractionalAmount(r.input,a[0].numerator,a[0].denominator),p=rt.fromFractionalAmount(r.output,n.numerator,n.denominator);case 34:return e.abrupt("return",new t({routes:[{inputAmount:s,outputAmount:p,route:r}],tradeType:u}));case 35:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.fromRoutes=function(){var e=d(c().mark((function e(r,n){var u,a,s,p,d,l,f,h,m,g,k,y,x;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=[],a=v(r);case 2:if((s=a()).done){e.next=43;break}if(d=(p=s.value).route,l=p.amount,f=new Array(d.tokenPath.length),h=void 0,m=void 0,n!==o.TradeType.EXACT_INPUT){e.next=25;break}l.currency.equals(d.input)||i(!1),h=rt.fromFractionalAmount(d.input,l.numerator,l.denominator),f[0]=rt.fromFractionalAmount(d.input.wrapped,l.numerator,l.denominator),g=0;case 12:if(!(g<d.tokenPath.length-1)){e.next=22;break}return k=d.pools[g],e.next=16,k.getOutputAmount(f[g]);case 16:f[g+1]=e.sent[0];case 19:g++,e.next=12;break;case 22:m=rt.fromFractionalAmount(d.output,f[f.length-1].numerator,f[f.length-1].denominator),e.next=40;break;case 25:l.currency.equals(d.output)||i(!1),m=rt.fromFractionalAmount(d.output,l.numerator,l.denominator),f[f.length-1]=rt.fromFractionalAmount(d.output.wrapped,l.numerator,l.denominator),y=d.tokenPath.length-1;case 29:if(!(y>0)){e.next=39;break}return x=d.pools[y-1],e.next=33,x.getInputAmount(f[y]);case 33:f[y-1]=e.sent[0];case 36:y--,e.next=29;break;case 39:h=rt.fromFractionalAmount(d.input,f[0].numerator,f[0].denominator);case 40:u.push({route:d,inputAmount:h,outputAmount:m});case 41:e.next=2;break;case 43:return e.abrupt("return",new t({routes:u,tradeType:n}));case 44:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),t.createUncheckedTrade=function(e){return new t(h({},e,{routes:[{inputAmount:e.inputAmount,outputAmount:e.outputAmount,route:e.route}]}))},t.createUncheckedTradeWithSimpleTrade=function(e){return t.createUncheckedTrade({route:new St([e.pool],e.tokenIn,e.tokenOut),inputAmount:rt.fromRawAmount(e.tokenIn,e.amountIn),outputAmount:rt.fromRawAmount(e.tokenOut,e.amountOut),tradeType:e.swapType})},t.createUncheckedTradeWithSimpleTrades=function(e){return t.createUncheckedTrade({route:new St(e.map((function(t){return t.pool})),e[0].tokenIn,e[e.length-1].tokenOut),inputAmount:rt.fromRawAmount(e[0].tokenIn,e[0].amountIn),outputAmount:rt.fromRawAmount(e[e.length-1].tokenOut,e[e.length-1].amountOut),tradeType:e[0].swapType})},t.createUncheckedTradeWithMultipleRoutes=function(e){return new t(e)};var e=t.prototype;return e.minimumAmountOut=function(t,e){if(void 0===e&&(e=this.outputAmount),this.tradeType===o.TradeType.EXACT_OUTPUT)return e;var r=new o.Fraction(b).add(t).invert().multiply(e.quotient).quotient;return rt.fromRawAmount(e.currency,r)},e.maximumAmountIn=function(t,e){if(void 0===e&&(e=this.inputAmount),console.log("maximumAmountIn",this.tradeType,o.TradeType.EXACT_INPUT),this.tradeType===o.TradeType.EXACT_INPUT)return e;var r=new o.Fraction(b).add(t).multiply(e.quotient).quotient;return rt.fromRawAmount(e.currency,r)},e.worstExecutionPrice=function(t){return new nt(this.inputAmount.currency,this.outputAmount.currency,this.maximumAmountIn(t).quotient,this.minimumAmountOut(t).quotient)},t.bestTradeExactIn=function(){var e=d(c().mark((function e(r,n,o,u,a,s,p){var d,l,f,h,m,g,v,k,y,x;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f=void 0===(l=(d=void 0===u?{}:u).maxNumResults)?3:l,m=void 0===(h=d.maxHops)?3:h,void 0===a&&(a=[]),void 0===s&&(s=n),void 0===p&&(p=[]),r.length>0||i(!1),m>0||i(!1),n===s||a.length>0||i(!1),g=s.wrapped,v=0;case 9:if(!(v<r.length)){e.next=34;break}if((k=r[v]).token0.equals(g.currency)||k.token1.equals(g.currency)){e.next=13;break}return e.abrupt("continue",31);case 13:return y=void 0,e.prev=14,e.next=18,k.getOutputAmount(g);case 18:y=e.sent[0],e.next=27;break;case 22:if(e.prev=22,e.t0=e.catch(14),!e.t0.isInsufficientInputAmountError){e.next=26;break}return e.abrupt("continue",31);case 26:throw e.t0;case 27:if(!(m>1&&r.length>1)){e.next=31;break}return x=r.slice(0,v).concat(r.slice(v+1,r.length)),e.next=31,t.bestTradeExactIn(x,n,o,{maxNumResults:f,maxHops:m-1},[].concat(a,[k]),y,p);case 31:v++,e.next=9;break;case 34:return e.abrupt("return",p);case 35:case"end":return e.stop()}}),e,null,[[14,22]])})));return function(t,r,n,i,o,u,a){return e.apply(this,arguments)}}(),t.bestTradeExactOut=function(){var e=d(c().mark((function e(r,n,u,a,s,p,d){var l,f,h,m,g,v,k,y,x,w,A;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h=void 0===(f=(l=void 0===a?{}:a).maxNumResults)?3:f,g=void 0===(m=l.maxHops)?3:m,void 0===s&&(s=[]),void 0===p&&(p=u),void 0===d&&(d=[]),r.length>0||i(!1),g>0||i(!1),u===p||s.length>0||i(!1),v=p.wrapped,k=n.wrapped,y=0;case 10:if(!(y<r.length)){e.next=46;break}if((x=r[y]).token0.equals(v.currency)||x.token1.equals(v.currency)){e.next=14;break}return e.abrupt("continue",43);case 14:return w=void 0,e.prev=15,e.next=19,x.getInputAmount(v);case 19:w=e.sent[0],e.next=28;break;case 23:if(e.prev=23,e.t0=e.catch(15),!e.t0.isInsufficientReservesError){e.next=27;break}return e.abrupt("continue",43);case 27:throw e.t0;case 28:if(!w.currency.equals(k)){e.next=39;break}return e.t1=o.sortedInsert,e.t2=d,e.next=33,t.fromRoute(new St([x].concat(s),n,u.currency),u,o.TradeType.EXACT_OUTPUT);case 33:e.t3=e.sent,e.t4=h,e.t5=_t,(0,e.t1)(e.t2,e.t3,e.t4,e.t5),e.next=43;break;case 39:if(!(g>1&&r.length>1)){e.next=43;break}return A=r.slice(0,y).concat(r.slice(y+1,r.length)),e.next=43,t.bestTradeExactOut(A,n,u,{maxNumResults:h,maxHops:g-1},[x].concat(s),w,d);case 43:y++,e.next=10;break;case 46:return e.abrupt("return",d);case 47:case"end":return e.stop()}}),e,null,[[15,23]])})));return function(t,r,n,i,o,u,a){return e.apply(this,arguments)}}(),f(t,[{key:"route",get:function(){return 1!=this.swaps.length&&i(!1),this.swaps[0].route}},{key:"inputAmount",get:function(){if(this._inputAmount)return this._inputAmount;var t=this.swaps[0].inputAmount.currency,e=this.swaps.map((function(t){return t.inputAmount})).reduce((function(t,e){return t.add(e)}),rt.fromRawAmount(t,0));return this._inputAmount=e,this._inputAmount}},{key:"outputAmount",get:function(){if(this._outputAmount)return this._outputAmount;var t=this.swaps[0].outputAmount.currency,e=this.swaps.map((function(t){return t.outputAmount})).reduce((function(t,e){return t.add(e)}),rt.fromRawAmount(t,0));return this._outputAmount=e,this._outputAmount}},{key:"executionPrice",get:function(){var t;return null!=(t=this._executionPrice)?t:this._executionPrice=new nt(this.inputAmount.currency,this.outputAmount.currency,this.inputAmount.quotient,this.outputAmount.quotient)}},{key:"priceImpact",get:function(){if(this._priceImpact)return this._priceImpact;for(var t,e=rt.fromRawAmount(this.outputAmount.currency,0),r=v(this.swaps);!(t=r()).done;){var n=t.value;e=e.add(n.route.midPrice.quote(n.inputAmount))}var i=e.subtract(this.outputAmount).divide(e);return this._priceImpact=new o.Percent(i.numerator,i.denominator),this._priceImpact}}]),t}(),Ot=function(){function t(t,e,r,n){this.address=t.replace(" ",""),this.decimals=e,this.symbol=r,this.name=n}var e=t.prototype;return e.equals=function(t){return this.address===t.address},e.sortsBefore=function(t){return this.address===t.address&&i(!1),this.address.length<t.address.length||!(this.address.length>t.address.length)&&this.address<t.address},f(t,[{key:"wrapped",get:function(){return this}}]),t}(),Et=function(){function t(){}return t.getPoolResourceType=function(t,e,r,n){return t+"::pool::Pool<"+e+", "+r+", "+t+x(n)+">"},t.fetchCoinStoreId=function(){var t=d(c().mark((function t(e,r,n){var i,o,u;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=new s.JsonRpcProvider(n),o=r+"::pool::CoinStoreCreatedEvent<"+e+">",t.next=4,i.getEvents({MoveEvent:o},null,1);case 4:if((u=t.sent)&&u.data&&0!=u.data.length){t.next=7;break}return t.abrupt("return",void 0);case 7:return t.abrupt("return",u.data[0].event.moveEvent.fields.id);case 8:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),t.fetchPool=function(){var e=d(c().mark((function e(r,i,o,u,a){var p,d,l,f,h,m,g,v,k,y;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p=new s.JsonRpcProvider(a),d=u+"::pool::NewPoolEvent<"+r+", "+i+", "+u+x(o)+">",e.t0=Promise,e.next=5,t.fetchCoinInfo(r,a);case 5:return e.t1=e.sent,e.next=8,t.fetchCoinInfo(i,a);case 8:return e.t2=e.sent,e.next=11,p.getEvents({MoveEvent:d},null,1);case 11:return e.t3=e.sent,e.t4=[e.t1,e.t2,e.t3],e.next=15,e.t0.all.call(e.t0,e.t4);case 15:if(f=(l=e.sent)[0],h=l[1],(m=l[2])&&m.data&&0!=m.data.length){e.next=21;break}throw new Error("pool not exist");case 21:return g=m.data[0].event.moveEvent.fields.pool_address,e.next=25,p.getObject(g);case 25:return k=new It(f,h,o,(v=e.sent.details.data.fields).slot0.fields.sqrt_price_x96,v.liquidity,at(v.slot0.fields.tick.fields),[],g),y={reserve0:v.reserve_0,reserve1:v.reserve_1,fee:parseInt(v.fee),tickSpacing:at(v.tick_spacing.fields),maxLiquidityPerTick:v.max_liquidity_per_tick,feeGrowthGlobal0X128:v.fee_growth_global0_X128,feeGrowthGlobal1X128:v.fee_growth_global1_X128,protocolFees:{token0:v.protocol_fees.fields.token0,token1:v.protocol_fees.fields.token1},liquidity:v.liquidity,slot0:{sqrtPriceX96:n.BigInt(v.slot0.fields.sqrt_price_x96),tick:at(v.slot0.fields.tick.fields),observationIndex:v.slot0.fields.observation_index,observationCardinality:v.slot0.fields.observation_cardinality,observationCardinalityNext:v.slot0.fields.observation_cardinality_next,feeProtocol:v.slot0.fields.fee_protocol,unlocked:v.slot0.fields.unlocked},poolAddress:g,tickHandle:v.ticks.fields.id.id,tickBitmapHandle:v.tick_bitmap.fields.id.id,positionHandle:v.positions.fields.id.id,observationHandle:v.observations.fields.id.id,initializedTicks:v.initialized_ticks.map((function(t){return t.fields})).map((function(t){return at(t)}))},e.abrupt("return",{pool:k,poolState:y});case 30:case"end":return e.stop()}}),e)})));return function(t,r,n,i,o){return e.apply(this,arguments)}}(),t.fetchCoinInfo=function(){var t=d(c().mark((function t(e,r){var n,i,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=e).startsWith("coin::Coin<")&&(n=n.substring("coin::Coin<".length,n.length-1)),n=n.replace(" ",""),i=new s.JsonRpcProvider(r),t.next=6,i.getCoinMetadata(n);case 6:return t.abrupt("return",new Ot(n,(o=t.sent).decimals,o.symbol,o.name));case 8:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),t.fetchPoolLiquidity=function(){var t=d(c().mark((function t(e,r,n,i,o){var u,a,p,d;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=new s.JsonRpcProvider(o),a=i+"::pool::NewPoolEvent<"+e+", "+r+", "+i+x(n)+">",t.next=4,u.getEvents({MoveEvent:a},null,1);case 4:if((p=t.sent)&&p.data&&0!=p.data.length){t.next=7;break}throw new Error("pool not exist");case 7:return d=p.data[0].event.moveEvent.fields.pool_address,t.next=11,u.getObject(d);case 11:return t.abrupt("return",t.sent.details.data.fields.liquidity);case 14:case"end":return t.stop()}}),t)})));return function(e,r,n,i,o){return t.apply(this,arguments)}}(),t.fetchSimplePoolInfo=function(){var t=d(c().mark((function t(e,r){var n,i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new s.JsonRpcProvider(r),t.next=3,n.getObject(e);case 3:return t.abrupt("return",{liquidity:(i=t.sent.details.data.fields).liquidity,reserve0:i.reserve_0,reserve1:i.reserve_1});case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),t.fetchNFTPosition=function(){var t=d(c().mark((function t(e,r){var i,o,u,a;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=new s.JsonRpcProvider(r),t.next=3,i.getObject(e);case 3:if((o=t.sent)&&"Exists"===o.status){t.next=6;break}throw new Error("no position associated");case 6:return u=xt(o.details.data.type),a=o.details.data.fields,console.log(a),t.abrupt("return",{token0:wt(u.struct.typeParams[0]),token1:wt(u.struct.typeParams[1]),fee:w(wt(u.struct.typeParams[2])),id:e,tickLower:at(a.tick_lower.fields),tickUpper:at(a.tick_upper.fields),liquidity:a.liquidity,feeGrowthInside0LastX128:n.BigInt(a.fee_growth_inside0_last_X128),feeGrowthInside1LastX128:n.BigInt(a.fee_growth_inside1_last_X128),tokensOwned0:a.tokens_owed0,tokensOwned1:a.tokens_owed1});case 10:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),t.fetchNFTPositions=function(){var e=d(c().mark((function e(r,n,i){var o,u,a,p;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new s.JsonRpcProvider(i),e.next=3,o.getObjectsOwnedByAddress(r);case 3:if((u=e.sent)&&0!=u.length){e.next=6;break}return e.abrupt("return",[]);case 6:return u=u.filter((function(t){return t.type.startsWith(n+"::router::LiquidityPosition<")})),a=u.map((function(t){return t.objectId})),p=function(){var e=d(c().mark((function e(r){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=lt(d(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.fetchNFTPosition(r,i));case 1:case"end":return e.stop()}}),e)})))))){e.next=3;break}throw new Error("cant read position "+r);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=11,Promise.all(a.map((function(t){return p(t)})));case 11:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.sortTicks=function(t){return t.sort((function(t,e){return t.index-e.index}))},t.sortSimpleTicks=function(t){return t.sort((function(t,e){return t.index-e.index}))},t.toTicks=function(t){return t.map((function(t){return new At({index:t.index,liquidityGross:t.liquidityGross,liquidityNet:t.liquidityNet})}))},t.simpleStatetoTicks=function(t){return t.map((function(t){return new At({index:t.index,liquidityGross:n.BigInt(t.liquidityGross),liquidityNet:n.BigInt(t.liquidityNet)})}))},t}(),Bt=function(){function t(t,e,r,n){this.moduleAddress=t,this.poolConfig=e,this.poolIdsList=r,this.sharedPositionOwnership=n}var e=t.prototype;return e.getModuleAddress=function(){return this.moduleAddress},e.makeCreatePoolTxWithAmounts=function(){var t=d(c().mark((function t(e,r,n,i,o,u,a,s,p,d,l,f,h,m,g,v,k){var y,x;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Et.fetchCoinInfo(e,v);case 2:return y=t.sent,t.next=5,Et.fetchCoinInfo(r,v);case 5:return x=this.createPosition(y,t.sent,a,s,p,d,l,f,h),t.next=9,this.makeCreatePoolTx(n,i,o,u,x,m,g,k);case 9:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i,o,u,a,s,c,p,d,l,f,h,m,g,v){return t.apply(this,arguments)}}(),e.createPosition=function(t,e,r,i,o,u,a,s,c){var p=J(X.getTickAtSqrtRatio(n.BigInt(a)),k[u]),d=J(X.getTickAtSqrtRatio(n.BigInt(s)),k[u]),l=J(X.getTickAtSqrtRatio(n.BigInt(c)),k[u]),f=new It(t,e,u,X.getSqrtRatioAtTick(p),"0",p);return qt.fromAmounts({pool:f,tickLower:d,tickUpper:l,amount0:r,amount1:i,useFullPrecision:o})},e.makeCreatePoolTx=function(){var t=d(c().mark((function t(e,r,n,i,o,u,a,s){var p,d;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p=[o.pool.token0.address,o.pool.token1.address,this.moduleAddress+x(o.pool.fee)],d={packageObjectId:this.getModuleAddress(),module:"router",function:"create_pool",typeArguments:p,arguments:[this.poolConfig,this.poolIdsList,this.sharedPositionOwnership,e,r,a,n,i,o.mintAmounts.amount0.toString(),o.mintAmounts.amount1.toString(),""+(o.tickLower>=0?o.tickLower:-o.tickLower),o.tickLower>=0,""+(o.tickUpper>=0?o.tickUpper:-o.tickUpper),o.tickUpper>=0,o.pool.sqrtRatioX96.toString(),""+u.toString()],gasBudget:s},t.abrupt("return",{kind:"moveCall",data:d});case 3:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i,o,u,a,s){return t.apply(this,arguments)}}(),e.makeMintTx=function(){var t=d(c().mark((function t(e,r,u,a,s,p,d,l,f){var h,m,g,v,k,y,w,A,b;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.greaterThan(s.liquidity,T)||i(!1),g=(m=s.mintAmounts).amount0,v=m.amount1,k=s.mintAmountsWithSlippage(new o.Percent(p.numerator,p.denominator)),y=k.amount0.toString(),w=k.amount1.toString(),A=[s.pool.token0.address,s.pool.token1.address,this.moduleAddress+x(s.pool.fee)],s.pool.objectId){t.next=8;break}throw new Error("invalid pool object id");case 8:return b={packageObjectId:this.getModuleAddress(),module:"router",function:"mint",typeArguments:A,arguments:[this.poolConfig,null==(h=s.pool.objectId)?void 0:h.toString(),this.sharedPositionOwnership,e,r,u,a,""+(s.tickLower>=0?s.tickLower:-s.tickLower),s.tickLower>=0,""+(s.tickUpper>=0?s.tickUpper:-s.tickUpper),s.tickUpper>=0,g.toString(),v.toString(),y,w,d,""+l.toString()],gasBudget:f},t.abrupt("return",{kind:"moveCall",data:b});case 10:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i,o,u,a,s,c){return t.apply(this,arguments)}}(),e.makeIncreaseLiquidityTx=function(){var t=d(c().mark((function t(e,r,u,a,s,p,d,l,f){var h,m,g,v,k,y,w,A;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.greaterThan(s.liquidity,T)||i(!1),m=(h=s.mintAmounts).amount0,g=h.amount1,v=s.mintAmountsWithSlippage(new o.Percent(d.numerator,d.denominator)),k=v.amount0.toString(),y=v.amount1.toString(),w=[s.pool.token0.address,s.pool.token1.address,this.moduleAddress+x(s.pool.fee)],A={packageObjectId:this.getModuleAddress(),module:"router",function:"increase_liquidity",typeArguments:w,arguments:[this.poolConfig,(s.pool.objectId?s.pool.objectId:"0").toString(),this.sharedPositionOwnership,e,r,p,u,a,m.toString(),g.toString(),k,y,""+l.toString()],gasBudget:f},t.abrupt("return",{kind:"moveCall",data:A});case 8:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i,o,u,a,s,c){return t.apply(this,arguments)}}(),e.makeRemoveLiquidityTx=function(){var t=d(c().mark((function t(e,r,u,a,s,p,d,l){var f,h,m,g,v;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.greaterThan(u.liquidity,T)||i(!1),f=u.burnAmountsWithSlippage(new o.Percent(s.numerator,s.denominator)),h=f.amount0.toString(),m=f.amount1.toString(),g=[u.pool.token0.address,u.pool.token1.address,this.moduleAddress+x(u.pool.fee)],v={packageObjectId:this.getModuleAddress(),module:"router",function:"decrease_liquidity",typeArguments:g,arguments:[this.poolConfig,(u.pool.objectId?u.pool.objectId:"0").toString(),this.sharedPositionOwnership,e,r,a,u.liquidity.toString(),h,m,d,""+p.toString()],gasBudget:l},t.abrupt("return",{kind:"moveCall",data:v});case 7:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i,o,u,a,s){return t.apply(this,arguments)}}(),t}(),Ct=function(){function t(){}return t.encodeFeeBips=function(t){return ot(t.multiply(1e4).quotient)},t}(),Nt=function(){function t(){this.ticks=[]}t.fromSimpleTickStates=function(e){var r=new t;return r.ticks=Et.simpleStatetoTicks(Et.sortSimpleTicks(e)),r};var e=t.prototype;return e.getTick=function(){var t=d(c().mark((function t(e){var r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(r=this.ticks.find((function(t){return t.index==e})))){t.next=3;break}return t.abrupt("return",{liquidityNet:0});case 3:return t.abrupt("return",{liquidityNet:r.liquidityNet});case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.nextInitializedTickWithinOneWord=function(){var t=d(c().mark((function t(e,r,n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",W.nextInitializedTickWithinOneWord(this.ticks,e,r,n));case 1:case"end":return t.stop()}}),t,this)})));return function(e,r,n){return t.apply(this,arguments)}}(),t}(),Lt=function(){function t(t,e,r){this.moduleAddress=t,this.swapRouter=e,this.poolConfig=r}var e=t.prototype;return e.getModuleAddress=function(){return this.moduleAddress},e.getSwapRouterAddress=function(){return this.swapRouter},e.getQuotes=function(){var t=d(c().mark((function t(e,r,n,i,u){var a,s,p,d,l,f,h,m,g,k,y,x,w,A;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=u.map((function(t){var e=t.pool;return e.updateTickProvider(Nt.fromSimpleTickStates(t.ticks)),e})),s=[],p=void 0,n!=o.TradeType.EXACT_INPUT){t.next=22;break}d=v(a);case 5:if((l=d()).done){t.next=20;break}return f=l.value,t.prev=7,t.next=10,Pt.exactIn(new St([f],e,r),rt.fromRawAmount(e,i));case 10:h=t.sent,(null==p||p.outputAmount.lessThan(h.outputAmount))&&(p=h),s.push({trade:h,isBest:!1}),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(7),console.log("error get quote",t.t0.toString());case 18:t.next=5;break;case 20:t.next=38;break;case 22:m=v(a);case 23:if((g=m()).done){t.next=38;break}return k=g.value,t.prev=25,t.next=28,Pt.exactOut(new St([k],e,r),rt.fromRawAmount(r,i));case 28:y=t.sent,(null==p||p.inputAmount.greaterThan(y.inputAmount))&&(p=y),s.push({trade:y,isBest:!1}),t.next=36;break;case 33:t.prev=33,t.t1=t.catch(25),console.log("error get quote",t.t1.toString());case 36:t.next=23;break;case 38:x=0,w=s;case 39:if(!(x<w.length)){t.next=47;break}if((A=w[x]).trade!=p){t.next=44;break}return A.isBest=!0,t.abrupt("break",47);case 44:x++,t.next=39;break;case 47:return t.abrupt("return",s);case 48:case"end":return t.stop()}}),t,null,[[7,15],[25,33]])})));return function(e,r,n,i,o){return t.apply(this,arguments)}}(),e.createSwapTx=function(t,e,r,n,u){var a=r.outputAmount.currency.wrapped;r.inputAmount.currency.wrapped.equals(r.inputAmount.currency.wrapped)||i(!1),r.outputAmount.currency.wrapped.equals(a)||i(!1);var s=n.deadline,c=r.swaps[0],p=c.route,d=c.inputAmount,l=c.outputAmount,f=1===p.pools.length,h=new o.Percent(n.slippageTolerance.numerator,n.slippageTolerance.denominator),m=r.maximumAmountIn(h,d).quotient.toString(),g=r.minimumAmountOut(h,l).quotient.toString();if(f){var v,k=p.pools[0],y=[k.token0.address.toString(),k.token1.address.toString(),this.moduleAddress+x(k.fee)],w=p.tokenPath[0].address.replace(" ","")==k.token0.address.replace(" ",""),A=[this.poolConfig,k.objectId?k.objectId.toString():"",t[k.token0.address],t[k.token1.address],w?e:[],w?[]:e,m,g,(null!=(v=n.sqrtPriceLimitX96)?v:0).toString(),w,s.toString()];return r.tradeType===o.TradeType.EXACT_INPUT?{kind:"moveCall",data:{packageObjectId:this.getSwapRouterAddress(),module:"swap_router",function:"exact_input_2",typeArguments:y,arguments:A,gasBudget:u}}:{kind:"moveCall",data:{packageObjectId:this.getSwapRouterAddress(),module:"swap_router",function:"exact_output_2",typeArguments:y,arguments:A,gasBudget:u}}}if(2==p.pools.length){var T,b=p.pools,I=[b[0].token0.address,b[0].token1.address],q=I[0],S=I[1],_=b[1].token0.address==q||b[1].token0.address==S?b[1].token1.address:b[1].token0.address;if(!mt(S,_)){var R=[_,S];if(_=R[1],!mt(q,S=R[0])){var P=[S,q];q=P[0],S=P[1]}}var O=q,E=r.tradeType===o.TradeType.EXACT_INPUT?"exact_input_two_hops":"exact_output_two_hops",B=[e,[],[]];p.input.address===S?B=[[],e,[]]:p.input.address===_&&(B=[[],[],e]);var C=b[0].token0.address==q&&b[0].token1.address==S?b[0]:b[1],N=b[0].token0.address==q&&b[0].token1.address==S?b[1]:b[0];O!==p.input.address&&O!==p.output.address||(O=S,C=b[0].token0.address==q&&b[0].token1.address==S?b[0]:b[1],N=b[0].token0.address==q&&b[0].token1.address==S?b[1]:b[0]),O!==p.input.address&&O!==p.output.address||(O=_,C=b[0].token0.address==q&&b[0].token1.address==_?b[0]:b[1],N=b[0].token0.address==q&&b[0].token1.address==_?b[1]:b[0]);var L=[q,S,_,p.input.address,p.output.address,this.moduleAddress+x(C.fee),this.moduleAddress+x(N.fee)],U=[this.poolConfig,C.objectId?C.objectId.toString():"",N.objectId?N.objectId.toString():"",t[q],t[S],t[_],B[0],B[1],B[2],m,g,(null!=(T=n.sqrtPriceLimitX96)?T:0).toString(),s.toString()];return{kind:"moveCall",data:{packageObjectId:this.getSwapRouterAddress(),module:"swap_router",function:E,typeArguments:L,arguments:U,gasBudget:u}}}if(3==p.pools.length){var F,X=p.pools,M=[X[0].token0.address,X[0].token1.address],j=M[0],D=M[1],W=X[1].token0.address==j||X[1].token0.address==D?X[1].token1.address:X[1].token0.address;if(!mt(D,W)){var G=[W,D];if(W=G[1],!mt(j,D=G[0])){var H=[D,j];j=H[0],D=H[1]}}var K=X[2].token0.address==p.output.address?X[2].token1.address:X[2].token0.address,z=j,Q=r.tradeType===o.TradeType.EXACT_INPUT?"exact_input_three_hops":"exact_output_three_hops",J=[e,[],[]];p.input.address===D?J=[[],e,[]]:p.input.address===W&&(J=[[],[],e]);var V=X[0].token0.address==j&&X[0].token1.address==D?X[0]:X[1],Y=X[0].token0.address==j&&X[0].token1.address==D?X[1]:X[0];z!==p.input.address&&z!==K||(z=D,V=X[0].token0.address==j&&X[0].token1.address==D?X[0]:X[1],Y=X[0].token0.address==j&&X[0].token1.address==D?X[1]:X[0]),z!==p.input.address&&z!==K||(z=W,V=X[0].token0.address==j&&X[0].token1.address==W?X[0]:X[1],Y=X[0].token0.address==j&&X[0].token1.address==W?X[1]:X[0]);var $=[j,D,W,p.input.address,K,p.output.address,this.moduleAddress+x(V.fee),this.moduleAddress+x(Y.fee),this.moduleAddress+x(X[2].fee)],Z=[this.poolConfig,V.objectId?V.objectId.toString():"",Y.objectId?Y.objectId.toString():"",X[2].objectId?X[2].objectId.toString():"",t[j],t[D],t[W],t[p.output.address],J[0],J[1],J[2],m,g,(null!=(F=n.sqrtPriceLimitX96)?F:0).toString(),s.toString()];return{kind:"moveCall",data:{packageObjectId:this.getSwapRouterAddress(),module:"swap_router",function:Q,typeArguments:$,arguments:Z,gasBudget:u}}}throw new Error("unsupported multihop")},t}();(Rt=exports.EventType||(exports.EventType={}))[Rt.MINT=100]="MINT",Rt[Rt.COLLECT=101]="COLLECT",Rt[Rt.COLLECT_PROTOCOL=102]="COLLECT_PROTOCOL",Rt[Rt.BURN=103]="BURN",Rt[Rt.SWAP=104]="SWAP",Rt[Rt.INCREASE_OBSERVATION_CARDINALITY_NEXT=105]="INCREASE_OBSERVATION_CARDINALITY_NEXT",Rt[Rt.SET_FEE_PROTOCOL_EVENT=106]="SET_FEE_PROTOCOL_EVENT",Rt[Rt.TICK_UPDATED_EVENT=107]="TICK_UPDATED_EVENT";var Ut=function(){function t(){}return t.fetchPoolUpdatedEvent=function(){var t=d(c().mark((function t(e,r,n,i){var o,u,a,p,l,f;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=new s.JsonRpcProvider(r),u=n||null,a=void 0!==i?i:1e4,t.next=5,lt(d(c().mark((function t(){var r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.getEvents({MoveEvent:e+"::pool::PoolUpdatedEvent"},u,a,"ascending");case 2:if((r=t.sent)&&0!=r.data.length){t.next=5;break}return t.abrupt("return",[]);case 5:return t.abrupt("return",r.data);case 6:case"end":return t.stop()}}),t)}))));case 5:return l=[],a=(p=t.sent)?p.length:0,f=null,p&&Array.isArray(p)&&p.length>0&&(p.forEach((function(t){var e=t.event.moveEvent.fields;l.push({token0Address:ht(e.t0),token1Address:ht(e.t1),feeAmount:w(ht(e.f)),isMint:e.is_mint,isNew:e.is_new,creator:e.creator,tick:at(e.tick.fields),tickLower:at(e.tick_lower.fields),tickUpper:at(e.tick_upper.fields),amount:e.amount,amount0:e.amount0,amount1:e.amount1,reserve0:e.reserve_0,reserve1:e.reserve_1,objectId:e.pool_address,liquidity:e.liquidity,sqrtPriceX96:X.getSqrtRatioAtTick(at(e.tick.fields))})})),f=p[p.length-1].id),t.abrupt("return",{poolUpdatedEvents:l,lastCursor:f});case 11:case"end":return t.stop()}}),t)})));return function(e,r,n,i){return t.apply(this,arguments)}}(),t.fetchTickUpdatedEvent=function(){var t=d(c().mark((function t(e,r,n,i,o){var u,a,p,l,f,h;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=new s.JsonRpcProvider(r),a=i||null,p=void 0!==o?o:1e4,t.next=5,lt(d(c().mark((function t(){var r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.getEvents({MoveEvent:e+"::pool::TickUpdatedEvent"},a,p,"ascending");case 2:if((r=t.sent)&&0!=r.data.length){t.next=5;break}return t.abrupt("return",[]);case 5:return t.abrupt("return",r.data);case 6:case"end":return t.stop()}}),t)}))));case 5:return f=[],p=(l=t.sent)?l.length:0,h=null,l&&Array.isArray(l)&&l.length>0&&(l.forEach((function(t){var e=t.event.moveEvent.fields,r=[ht(e.t0),ht(e.t1),w(ht(e.f))],i=r[0],o=r[1],u=r[2];(null==n||n.token0==i&&n.token1==o&&n.feeAmount==u)&&f.push({token0Address:i,token1Address:o,feeAmount:u,liquidityGross:e.liquidity_gross,liquidityNet:st(e.liquidity_net.fields),tick:at(e.tick.fields),reserve0:e.reserve_0,reserve1:e.reserve_1})})),h=l[l.length-1].id),t.abrupt("return",{tickUpdatedEvents:f,lastCursor:h});case 11:case"end":return t.stop()}}),t)})));return function(e,r,n,i,o){return t.apply(this,arguments)}}(),t.fetchGlobalSwapEvents=function(){var t=d(c().mark((function t(e,r,n,i){var o,u,a,p,l,f;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=new s.JsonRpcProvider(r),u=n||null,a=void 0!==i?i:1e4,t.next=5,lt(d(c().mark((function t(){var r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.getEvents({MoveEvent:e+"::pool::GlobalSwapEvent"},u,a,"ascending");case 2:if((r=t.sent)&&0!=r.data.length){t.next=5;break}return t.abrupt("return",[]);case 5:return t.abrupt("return",r.data);case 6:case"end":return t.stop()}}),t)}))));case 5:return l=[],a=(p=t.sent)?p.length:0,f=null,p&&Array.isArray(p)&&p.length>0&&(p.forEach((function(t){var e=t.event.moveEvent.fields;l.push({token0Address:ht(e.t0),token1Address:ht(e.t1),feeAmount:w(ht(e.f)),recipient:e.recipient,amount0:ct(e.amount0.fields),amount1:ct(e.amount1.fields),sqrtPriceX96:e.sqrt_price_x96,liquidity:e.liquidity,tick:at(e.tick.fields),reserve0:e.reserve_0,reserve1:e.reserve_1})})),f=p[p.length-1].id),t.abrupt("return",{swapEvents:l,lastCursor:f});case 11:case"end":return t.stop()}}),t)})));return function(e,r,n,i){return t.apply(this,arguments)}}(),t}();exports.CurrencyAmount=rt,exports.EventFetcher=Ut,exports.FullMath=_,exports.LiquidityMath=S,exports.NoTickDataProvider=M,exports.Payments=Ct,exports.Pool=It,exports.Position=qt,exports.PositionLibrary=tt,exports.PositionManager=Bt,exports.Price=nt,exports.Route=St,exports.SimpleTickDataProvider=Nt,exports.SqrtPriceMath=O,exports.StateFetcher=Et,exports.SuiCoin=Ot,exports.SwapMath=B,exports.SwapRouter=Lt,exports.TICK_SPACINGS=k,exports.Tick=At,exports.TickLibrary=$,exports.TickList=W,exports.TickListDataProvider=Tt,exports.TickMath=X,exports.Trade=Pt,exports.TypeTagSerializer=yt,exports.bnToBigInt=ut,exports.decimalToHexString=function(t){var e="";if(t<0)for(e=(t>>>0).toString(16);e.length<16;)e="F"+e;else for(e=t.toString(16);e.length<16;)e="0"+e;return e},exports.encodeSqrtRatioX96=G,exports.feeTypeToFeeAmount=w,exports.getFeeType=x,exports.getModuleAddress=function(){return y},exports.hexToBN=function(t){return t.replace("0x","")},exports.i128ToBigInt=st,exports.i256ToBigInt=ct,exports.i64ToNumber=at,exports.isSorted=j,exports.maxLiquidityForAmounts=Q,exports.mostSignificantBit=L,exports.nearestUsableTick=J,exports.parseTypeFromStr=xt,exports.priceToClosestTick=function(t){var e=t.baseCurrency.sortsBefore(t.quoteCurrency),r=e?G(t.numerator,t.denominator):G(t.denominator,t.numerator),n=X.getTickAtSqrtRatio(r),i=it(t.baseCurrency,t.quoteCurrency,n+1);return e?t.lessThan(i)||n++:t.greaterThan(i)||n++,n},exports.setModuleAddress=function(t){y=t},exports.sleep=pt,exports.sortBefore=mt,exports.sortTypes=function(t,e){return mt(t,e)?{token0:t,token1:e}:{token0:e,token1:t}},exports.structTagToString=wt,exports.subIn256=Y,exports.tickToPrice=it,exports.toFullyQualifiedName=function(t){return t},exports.toHex=ot,exports.toUTF8Array=function(t){for(var e=[],r=0;r<t.length;r++){var n=t.charCodeAt(r);n<128?e.push(n):n<2048?e.push(192|n>>6,128|63&n):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|63&n):(r++,n=65536+((1023&n)<<10|1023&t.charCodeAt(r)),e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return e},exports.tradeComparator=_t,exports.tryCallWithTrial=lt,exports.typeInfoToQualifiedName=ht,exports.validateAndParseAddress=function(t){var e="";try{t.match(/^(0x)?[0-9a-fA-F]{64}$/)&&(e="0x"!==t.substring(0,2)?"0x"+t:t)}catch(e){throw new Error(t+" is not a valid address.")}return e};
//# sourceMappingURL=sui-sdk.cjs.production.min.js.map
